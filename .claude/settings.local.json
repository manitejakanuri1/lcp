{
  "permissions": {
    "allow": [
      "Bash(npm run lint:*)",
      "Bash(npm run dev:*)",
      "Bash(timeout 10 tail:*)",
      "Bash(netstat:*)",
      "Bash(findstr:*)",
      "Bash(npm start)",
      "Bash(curl:*)",
      "Bash(ls:*)",
      "Bash(powershell \"Get-NetTCPConnection -LocalPort 3000,8080 -State Listen -ErrorAction SilentlyContinue | Select-Object LocalPort,State,OwningProcess | Format-Table\")",
      "Bash(powershell \"Get-Process -Id 20880 | Select-Object Id,ProcessName,CPU,WorkingSet | Format-Table\")",
      "Bash(powershell \"Get-Process -Id 10388 | Select-Object Id,ProcessName,CPU,WorkingSet | Format-Table\")",
      "Bash(powershell:*)",
      "Bash(node scripts/check-user.js:*)",
      "Bash(node scripts/migrate-passwords.js:*)",
      "Bash(node scripts/migrate-passwords-auto.js:*)",
      "Bash(node -e:*)",
      "Bash(node scripts/test-voices-tts.js:*)",
      "Bash(node scripts/generate-voice-previews.js:*)",
      "Bash(Start-Sleep -Seconds 5)",
      "Bash(Get-Content \"C:\\\\Users\\\\manit\\\\AppData\\\\Local\\\\Temp\\\\claude\\\\C--Users-manit--gemini-antigravity-playground\\\\tasks\\\\bdde78d.output\")",
      "Bash(node:*)",
      "Bash(npm install)",
      "Bash(test:*)",
      "Bash(pkill:*)",
      "Bash(tasklist:*)",
      "Bash(taskkill:*)",
      "Bash(ping:*)",
      "Bash(echo:*)",
      "Bash(npx supabase:*)",
      "Bash(start /B node server.js)",
      "Bash(timeout /t 5 /nobreak)",
      "Bash(tee:*)",
      "Bash(xargs:*)",
      "Bash(git init:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(npm install:*)",
      "Bash(lsof:*)",
      "Bash(git checkout:*)",
      "Bash(gh pr create --title \"ðŸ§ª Test: CodeRabbit Demo - Intentional Issues\" --body \"$\\(cat <<''EOF''\n## Purpose\nThis PR demonstrates CodeRabbit''s AI-powered code review capabilities by intentionally including common security and quality issues.\n\n## What CodeRabbit Should Catch\n\n### ðŸ”’ Security Issues \\(High Priority\\)\n- [ ] **SSRF vulnerability**: Unvalidated URL fetching in line 18\n- [ ] **XSS vulnerability**: Unsanitized user input in HTML \\(line 52\\)\n- [ ] **Sensitive data exposure**: Password logging \\(line 26\\)\n- [ ] **SQL injection risk**: Example code pattern \\(line 16\\)\n- [ ] **Missing authentication**: No auth check on endpoints\n\n### ðŸ—ï¸ Code Quality Issues\n- [ ] **Missing input validation**: No Zod schema usage\n- [ ] **Race condition**: Non-transactional counter update \\(lines 31-34\\)\n- [ ] **Poor error handling**: Exposing stack traces to client \\(line 41\\)\n- [ ] **Missing Bearer prefix**: API key header format \\(line 30\\)\n\n### ðŸ§ª Test Quality Issues\n- [ ] **No error coverage**: Only happy path tested\n- [ ] **Flaky async test**: Timing-dependent assertion \\(line 11\\)\n- [ ] **Unclear assertions**: Using `toBeTruthy\\(\\)` instead of exact values\n- [ ] **Missing cleanup**: No `afterEach` for mocks\n- [ ] **Low coverage**: Missing edge cases\n\n## Expected CodeRabbit Feedback\nCodeRabbit should provide:\n1. Severity ratings for each issue\n2. Specific line-by-line suggestions\n3. Code examples for fixes\n4. Security best practices references\n\n## How to Fix \\(After CodeRabbit Review\\)\nOnce CodeRabbit reviews this PR, I''ll push fixes for all issues it identifies, demonstrating the autonomous AI workflow.\n\n---\n\n**Note**: This is a demonstration PR. Do NOT merge until all issues are fixed!\n\nðŸ¤– This PR tests the CodeRabbit + Claude Code integration workflow.\nEOF\n\\)\" --base master)",
      "Bash(winget install:*)",
      "Bash(gh auth:*)",
      "WebFetch(domain:github.com)",
      "Bash(git rm:*)",
      "Bash(git reset:*)",
      "Bash(git merge:*)",
      "Bash(git pull:*)",
      "Bash(gh pr create:*)",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" --version)",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" pr create --title \"Security Hardening: Complete CodeRabbit Full Project Review\" --body \"## ðŸ”’ Full Project Security Review Request\n\n@coderabbitai Please perform a **complete security audit** of the entire project from the beginning.\n\n### Review Scope: FULL PROJECT\n- Review ALL files in the repository\n- Check for security vulnerabilities across entire codebase\n- Verify all API endpoints are properly secured\n- Identify any missed security issues\n\n---\n\n## âœ… Security Fixes Implemented \\(9 Critical Fixes\\)\n\n### CRITICAL Vulnerabilities Fixed:\n\n**1. /api/agent/session - Missing Authentication**\n- âœ… Added auth\\(\\) check \\(401 if unauthorized\\)\n- âœ… Added agent ownership verification\n- âœ… Zod validation with sessionActionSchema\n- âœ… Winston logger \\(PII-safe\\)\n\n**2. /api/search-knowledge - Missing Authentication**\n- âœ… Added auth\\(\\) check \\(401 if unauthorized\\)\n- âœ… Added agent ownership verification  \n- âœ… Zod validation with searchKnowledgeSchema\n- âœ… Winston logger\n\n**3. /api/crawl-website - Missing Ownership Check**\n- âœ… Added agent ownership verification\n- âœ… Replaced manual URL validation with crawlWebsiteSchema\n- âœ… SSRF protection via centralized urlSchema\n- âœ… Winston logger\n\n**4. /api/tts - No Rate Limiting \\(DoS Risk\\)**\n- âœ… Rate limiting: 10 requests/minute per IP\n- âœ… Zod validation with ttsRequestSchema\n- âœ… Winston logger\n\n**5. /api/avatar - No Rate Limiting \\(Credit Abuse\\)**\n- âœ… Rate limiting: 5 requests/minute per IP\n- âœ… Winston logger\n\n### HIGH Priority Issues Fixed:\n\n**6. /api/agents/[id] PUT - Missing Input Validation**\n- âœ… Zod validation with updateAgentSchema\n- âœ… Added agent ownership verification\n- âœ… Winston logger\n\n**7. Centralized URL Validation - SSRF Protection**\n- âœ… Created centralized urlSchema\n- âœ… Validates protocol \\(http/https only\\)\n- âœ… Blocks private IP ranges\n\n**8. Missing Validation Schemas**\n- âœ… Added sessionActionSchema\n- âœ… Added crawlWebsiteSchema\n\n### MEDIUM Priority Issues Fixed:\n\n**9. Sensitive Data Logging**\n- âœ… Replaced all console.log with winston logger\n- âœ… Structured logging with PII redaction\n\n---\n\n## ðŸ“‹ Files Changed \\(9 files\\)\n\n**API Routes:** 7 files security-hardened\n**Library:** validation.ts enhanced\n**Documentation:** SECURITY-HARDENING-STATUS.md created\n**Deleted:** 2 demo files removed\n\n---\n\n## ðŸŽ¯ Security Improvements\n\n| Category | Before | After |\n|----------|--------|-------|\n| Authentication | âŒ Missing | âœ… Required |\n| Authorization | âŒ No checks | âœ… Ownership verified |\n| Rate Limiting | âŒ None | âœ… IP-based limits |\n| Input Validation | âŒ Manual | âœ… Zod schemas |\n| Logging | âŒ console.log | âœ… Winston \\(PII-safe\\) |\n\n---\n\n## ðŸš€ Status: PRODUCTION READY âœ…\n\nSee SECURITY-HARDENING-STATUS.md for complete details.\n\n@coderabbitai full review\" --base master --head security-fixes-final)",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" auth login --web)",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" pr view 1)",
      "Bash(git ls-tree:*)",
      "Bash(dir:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nFix: Complete Vercel deployment configuration\n\n- Fix CORS to support production URLs \\(dynamic origin detection\\)\n- Add api/package.json for ES module support in serverless functions\n- Update vercel.json with build commands and function configuration\n- Add comprehensive deployment documentation \\(DEPLOYMENT.md\\)\n- Update README with deployment instructions and troubleshooting\n- Add .env.example for environment variable documentation\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(vercel --version:*)",
      "Bash(vercel login:*)",
      "Bash(vercel:*)",
      "Bash(node setup-founder.js:*)",
      "Bash(vercel ls:*)",
      "Bash(vercel --prod --yes:*)"
    ]
  }
}
